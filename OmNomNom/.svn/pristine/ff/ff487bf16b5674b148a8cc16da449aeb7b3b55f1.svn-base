package com.arhimag.games.omnomnom;

import android.util.Log;

import com.arhimag.games.omnomnom.Maps.GameMap;

public abstract class GameLevel
{
	private GameMap map;
	private Snake snake;
	private Food
	
	private boolean ticked = true;
	
	public GameLevel( int snakeStartX, int snakeStartY, GameMap map )
	{
		this.map = map;
		snake = new Snake(snakeStartX, snakeStartY);
	}
	
	public GameMap getMap()
	{
		return map;
	}
	
	public Snake getSnake()
	{
		return snake;
	}
	
	public void turnLeft()
	{
		if( ticked )
			snake.turnLeft();
		ticked = true;
	}
	
	public void turnRight()
	{
		if( ticked )
			snake.turnRight();
		ticked = true;
	}
	
	public void tick()
	{
		int nextFieldX = -1;
		int nextFieldY = -1;
		char nextFieldValue;
		
		snake.advance();
		
		if( snake.direction ==  snake.UP)
		{
			nextFieldX = snake.parts.get(0).x;
			nextFieldY = snake.parts.get(0).y - 1;
		} 
		else if( snake.direction == snake.DOWN )
		{
			nextFieldX = snake.parts.get(0).x;
			nextFieldY = snake.parts.get(0).y + 1;
		} 
		else if( snake.direction == snake.LEFT )
		{
			nextFieldX = snake.parts.get(0).x - 1;
			nextFieldY = snake.parts.get(0).y ;
		} 
		else if( snake.direction == snake.RIGHT )
		{
			nextFieldX = snake.parts.get(0).x + 1;
			nextFieldY = snake.parts.get(0).y;
		}		
		
		if( ( nextFieldX < 0 ) || 
			( nextFieldX >= map.getMapWidth() ) ||
			( nextFieldY < 0 ) ||
			( nextFieldY >= map.getMapHeight() ) )
			{
				Log.d("SnakeJourney", "Incorrect snake position!");
				throw new RuntimeException();
			}
		
		
		nextFieldValue = map.FlatMap[nextFieldX][nextFieldY];
		
		ticked = true;
	}
}
